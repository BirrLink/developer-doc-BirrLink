"use strict";(globalThis.webpackChunkbirrlink_docs=globalThis.webpackChunkbirrlink_docs||[]).push([[330],{4667:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"webhooks/overview","title":"Webhook Events Overview","description":"Webhooks allow you to receive real-time notifications about events happening in your BirrLink account. Instead of polling the API for updates, BirrLink will send HTTP POST requests to your specified URLs when certain events occur.","source":"@site/docs/webhooks/overview.md","sourceDirName":"webhooks","slug":"/webhooks/overview","permalink":"/docs/webhooks/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/birrlink/birrlink-docs/edit/main/docs/webhooks/overview.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Card Integration","permalink":"/docs/payment-methods/cards"},"next":{"title":"Webhook Security","permalink":"/docs/webhooks/security"}}');var s=i(4848),o=i(8453);const r={sidebar_position:1},l="Webhook Events Overview",a={},d=[{value:"How Webhooks Work",id:"how-webhooks-work",level:2},{value:"Registering Webhooks",id:"registering-webhooks",level:2},{value:"Via API",id:"via-api",level:3},{value:"Via Dashboard",id:"via-dashboard",level:3},{value:"Webhook Payload Format",id:"webhook-payload-format",level:2},{value:"Example Payment Completed Event",id:"example-payment-completed-event",level:3},{value:"Available Events",id:"available-events",level:2},{value:"Payment Events",id:"payment-events",level:3},{value:"Refund Events",id:"refund-events",level:3},{value:"Customer Events",id:"customer-events",level:3},{value:"Receiving Webhooks",id:"receiving-webhooks",level:2},{value:"Endpoint Requirements",id:"endpoint-requirements",level:3},{value:"Example Endpoint (Node.js)",id:"example-endpoint-nodejs",level:3},{value:"Example Endpoint (Python)",id:"example-endpoint-python",level:3},{value:"Security",id:"security",level:2},{value:"Signature Verification",id:"signature-verification",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Reliability",id:"reliability",level:2},{value:"Retry Mechanism",id:"retry-mechanism",level:3},{value:"Handling Delays",id:"handling-delays",level:3},{value:"Testing Webhooks",id:"testing-webhooks",level:2},{value:"Using Webhook Testing Tools",id:"using-webhook-testing-tools",level:3},{value:"Simulating Events",id:"simulating-events",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"webhook-events-overview",children:"Webhook Events Overview"})}),"\n",(0,s.jsx)(n.p,{children:"Webhooks allow you to receive real-time notifications about events happening in your BirrLink account. Instead of polling the API for updates, BirrLink will send HTTP POST requests to your specified URLs when certain events occur."}),"\n",(0,s.jsx)(n.h2,{id:"how-webhooks-work",children:"How Webhooks Work"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"You register one or more webhook endpoints with BirrLink"}),"\n",(0,s.jsx)(n.li,{children:"When an event occurs (like a payment completion), BirrLink sends an HTTP POST request to your webhook URL"}),"\n",(0,s.jsx)(n.li,{children:"Your application processes the event and responds with a 200 status code"}),"\n",(0,s.jsx)(n.li,{children:"BirrLink considers the webhook delivered successfully"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"registering-webhooks",children:"Registering Webhooks"}),"\n",(0,s.jsx)(n.h3,{id:"via-api",children:"Via API"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl https://api.birrlink.com/v1/webhooks \\\n  -H "Authorization: Bearer YOUR_SECRET_API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "url": "https://yourwebsite.com/webhooks/birrlink",\n    "events": ["payment.completed", "payment.failed"],\n    "description": "Handle payment notifications"\n  }\'\n'})}),"\n",(0,s.jsx)(n.h3,{id:"via-dashboard",children:"Via Dashboard"}),"\n",(0,s.jsxs)(n.p,{children:["Alternatively, you can register webhooks through your ",(0,s.jsx)(n.a,{href:"https://dashboard.birrlink.com",children:"BirrLink Dashboard"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Log in to your dashboard"}),"\n",(0,s.jsxs)(n.li,{children:["Navigate to ",(0,s.jsx)(n.strong,{children:"Settings"})," \u2192 ",(0,s.jsx)(n.strong,{children:"Webhooks"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.strong,{children:"Add Webhook"})]}),"\n",(0,s.jsx)(n.li,{children:"Enter your webhook URL and select events"}),"\n",(0,s.jsx)(n.li,{children:"Save the webhook"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"webhook-payload-format",children:"Webhook Payload Format"}),"\n",(0,s.jsx)(n.p,{children:"All webhook events follow the same basic structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "evt_123456789",\n  "type": "payment.completed",\n  "created": 1678886400,\n  "livemode": false,\n  "data": {\n    "object": {\n      // Event-specific data\n    }\n  },\n  "previous_attributes": {\n    // For update events, contains previous values\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-payment-completed-event",children:"Example Payment Completed Event"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "evt_123456789",\n  "type": "payment.completed",\n  "created": 1678886400,\n  "livemode": false,\n  "data": {\n    "object": {\n      "id": "pay_987654321",\n      "status": "completed",\n      "amount": 100.00,\n      "currency": "ETB",\n      "customer": {\n        "email": "customer@example.com",\n        "phone": "+251912345678"\n      },\n      "description": "Payment for order #12345",\n      "transaction_id": "txn_55667788",\n      "payment_method": "mobile_money",\n      "created_at": "2023-10-20T14:30:00Z",\n      "completed_at": "2023-10-20T14:35:00Z"\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"available-events",children:"Available Events"}),"\n",(0,s.jsx)(n.h3,{id:"payment-events",children:"Payment Events"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.created"}),": Payment request created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.pending"}),": Payment awaiting customer confirmation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.processing"}),": Payment being processed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.completed"}),": Payment successfully completed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.failed"}),": Payment failed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"payment.cancelled"}),": Payment cancelled by customer"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"refund-events",children:"Refund Events"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"refund.created"}),": Refund created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"refund.approved"}),": Refund approved"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"refund.completed"}),": Refund successfully processed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"refund.failed"}),": Refund failed"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"customer-events",children:"Customer Events"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"customer.created"}),": New customer created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"customer.updated"}),": Customer information updated"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"receiving-webhooks",children:"Receiving Webhooks"}),"\n",(0,s.jsx)(n.h3,{id:"endpoint-requirements",children:"Endpoint Requirements"}),"\n",(0,s.jsx)(n.p,{children:"Your webhook endpoint must:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Accept HTTP POST requests"}),"\n",(0,s.jsx)(n.li,{children:"Respond with a 200 status code within 10 seconds"}),"\n",(0,s.jsx)(n.li,{children:"Be accessible over HTTPS in production"}),"\n",(0,s.jsx)(n.li,{children:"Handle duplicate events gracefully"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-endpoint-nodejs",children:"Example Endpoint (Node.js)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"app.post('/webhooks/birrlink', express.raw({type: 'application/json'}), (req, res) => {\n  const sig = req.headers['birrlink-signature'];\n  const event = req.body;\n  \n  // Process different event types\n  switch (event.type) {\n    case 'payment.completed':\n      const payment = event.data.object;\n      console.log(`Payment ${payment.id} completed with amount ${payment.amount}`);\n      // Update your database, send confirmation email, etc.\n      break;\n    case 'payment.failed':\n      const failedPayment = event.data.object;\n      console.log(`Payment ${failedPayment.id} failed`);\n      // Handle failed payment, notify customer, etc.\n      break;\n    default:\n      console.log(`Unhandled event type ${event.type}`);\n  }\n\n  // Acknowledge receipt\n  res.status(200).send('OK');\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"example-endpoint-python",children:"Example Endpoint (Python)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from flask import Flask, request\nimport json\n\napp = Flask(__name__)\n\n@app.route('/webhooks/birrlink', methods=['POST'])\ndef webhook_handler():\n    event_json = request.get_json()\n    event_type = event_json['type']\n    \n    if event_type == 'payment.completed':\n        payment = event_json['data']['object']\n        print(f\"Payment {payment['id']} completed with amount {payment['amount']}\")\n        # Update your database, send confirmation email, etc.\n    elif event_type == 'payment.failed':\n        failed_payment = event_json['data']['object']\n        print(f\"Payment {failed_payment['id']} failed\")\n        # Handle failed payment, notify customer, etc.\n    else:\n        print(f\"Unhandled event type {event_type}\")\n    \n    # Acknowledge receipt\n    return 'OK', 200\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,s.jsx)(n.h3,{id:"signature-verification",children:"Signature Verification"}),"\n",(0,s.jsx)(n.p,{children:"BirrLink signs all webhook events with an HMAC-SHA256 signature to ensure authenticity:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"birrlink-signature: t=1678886400,v1=hmac_signature_here\n"})}),"\n",(0,s.jsx)(n.p,{children:"Verify signatures in your webhook handler:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Node.js:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\nconst verifySignature = (payload, signature, secret) => {\n  const expectedSignature = `t=${timestamp},v1=${crypto\n    .createHmac('sha256', secret)\n    .update(payload)\n    .digest('hex')}`;\n  \n  return crypto.timingSafeEqual(\n    Buffer.from(signature),\n    Buffer.from(expectedSignature)\n  );\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Python:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import hmac\nimport hashlib\n\ndef verify_signature(payload, signature, secret):\n    expected_signature = f\"t={timestamp},v1=\" + hmac.new(\n        secret.encode('utf-8'),\n        payload.encode('utf-8'),\n        hashlib.sha256\n    ).hexdigest()\n    \n    return hmac.compare_digest(signature, expected_signature)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Store your webhook signing secret securely"}),"\n",(0,s.jsx)(n.li,{children:"Always verify webhook signatures"}),"\n",(0,s.jsx)(n.li,{children:"Log webhook attempts for debugging"}),"\n",(0,s.jsx)(n.li,{children:"Implement rate limiting to prevent abuse"}),"\n",(0,s.jsx)(n.li,{children:"Use unique endpoints for different event types if needed"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"reliability",children:"Reliability"}),"\n",(0,s.jsx)(n.h3,{id:"retry-mechanism",children:"Retry Mechanism"}),"\n",(0,s.jsx)(n.p,{children:"BirrLink will attempt to deliver webhooks up to 3 times if:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Your server returns a non-200 status code"}),"\n",(0,s.jsx)(n.li,{children:"Your server doesn't respond within 10 seconds"}),"\n",(0,s.jsx)(n.li,{children:"Your server is unreachable"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The retry schedule is: immediately, after 1 minute, and after 10 minutes."}),"\n",(0,s.jsx)(n.h3,{id:"handling-delays",children:"Handling Delays"}),"\n",(0,s.jsx)(n.p,{children:"Webhooks are delivered on a best-effort basis but may experience delays during high traffic. Your application should be able to handle out-of-order events and implement idempotency to prevent duplicate processing."}),"\n",(0,s.jsx)(n.h2,{id:"testing-webhooks",children:"Testing Webhooks"}),"\n",(0,s.jsx)(n.h3,{id:"using-webhook-testing-tools",children:"Using Webhook Testing Tools"}),"\n",(0,s.jsxs)(n.p,{children:["Tools like ",(0,s.jsx)(n.a,{href:"https://ngrok.com",children:"ngrok"})," can expose your local development server to the internet for webhook testing:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ngrok http 3000\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then use the ngrok URL as your webhook endpoint in the sandbox environment."}),"\n",(0,s.jsx)(n.h3,{id:"simulating-events",children:"Simulating Events"}),"\n",(0,s.jsx)(n.p,{children:"Use the BirrLink Dashboard to simulate different webhook events in the sandbox environment to test your implementation."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(6540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);